Gem::Specification.new do |s|
  s.name = 'bio'
  s.version = "1.2.9.9501"

  s.author = "BioRuby project"
  s.email = "staff@bioruby.org"
  s.homepage = "http://bioruby.org/"
  s.rubyforge_project = "bioruby"
  s.summary = "Bioinformatics library"
  s.description = "BioRuby is a library for bioinformatics (biology + information science)."

  s.platform = Gem::Platform::RUBY
  s.files = [
    <% ###### Below is executed in ERB environment ######
    # Gets file list from the "git ls-files" command.
    files = (`git ls-files` rescue nil).to_s.split(/\r?\n/)
    files.delete_if { |x| x.empty? }
    # When git-ls-files isn't available, creates a list from current files.
    unless $?.success? or files.size <= 0 then
      files =
        [ "README.rdoc", "README_DEV.rdoc", 
          "ChangeLog", "KNOWN_ISSUES.rdoc",
          "Rakefile", "bioruby.gemspec.erb",
          "bioruby.gemspec", "setup.rb",
          "extconf.rb", "rdoc.zsh"
        ] + Dir.glob("{bin,doc,etc,lib,sample,test}/**/*").delete_if do |item|
              case item
              when /(\A|\/)CVS(\z|\/)/, /(\A|\/)rdoc(\z|\/)/, /\~\z/
                true
              else
                false
              end
            end
    end
    %><%= 
    files.collect { |x| x.dump }.join(",\n    ")
       ###### Above is executed in ERB environment ######
    %>
  ]

  s.has_rdoc = true
  s.extra_rdoc_files = [ 
    <%= ###### Below is executed in ERB environment ######
        # Files whose suffix are .rdoc are selected.
        rdoc_files = files.find_all { |item| /\.rdoc\z/ =~ item }
        # Fail safe settings
        if rdoc_files.empty? then
          rdoc_files = [ 'README.rdoc', 'README_DEV.rdoc',
                         'doc/Changes-1.3.rdoc' ]
        end
        rdoc_files.push "ChangeLog" unless rdoc_files.include?("ChangeLog")
        rdoc_files.collect { |x| x.dump }.join(",\n    ")
        ###### Above is executed in ERB environment ######
    %>
  ]
  s.rdoc_options << '--main' << 'README.rdoc'
  s.rdoc_options << '--title' << 'BioRuby API documentation'
  s.rdoc_options << '--exclude' << '\.yaml\z'
  s.rdoc_options << '--line-numbers' << '--inline-source'

  s.require_path = 'lib'
  s.autorequire = 'bio'

  s.bindir = "bin"
  s.executables = [
    <%= ###### Below is executed in ERB environment ######
        # Files in bin/ directory are selected.
        exec_files = files.find_all { |item| /\Abin\// =~ item }
        # Non-executable files are removed from the list.
        exec_files.delete_if { |item| !File.executable?(item) }
        # strip "bin/"
        exec_files.collect! { |item| item.sub(/\Abin\//, '') }
        # Fail safe settings
        if exec_files.empty? then
            exec_files = [ "bioruby", "br_biofetch.rb", "br_biogetseq.rb", "br_bioflat.rb", "br_pmfetch.rb" ]
        end
        exec_files.collect { |x| x.dump }.join(",\n    ")
        ###### Above is executed in ERB environment ######
    %>
  ]
  s.default_executable = "bioruby"
end
